<html>
<head>
    <script src="https://cdn.rawgit.com/ngopal/mlhelp/master/node_modules/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.rawgit.com/ngopal/mlhelp/master/node_modules/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css">
    <!--<link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ngopal/mlhelp/master/node_modules/b&lt;!&ndash;&ndash;&gt;ootstrap/dist/css/bootstrap.min.css">-->
    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ngopal/mlhelp/master/node_modules/bootstrap/dist/css/bootstrap-theme.min.css">
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
</head>

<body>

<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">mlhelp.org</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="#" onclick=showSurvey()>Home</a></li>
                <li><a href="#about" onclick=showAbout()>About</a></li>
                <li><a href="#contact" onclick=showContact()>Already an expert?</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class="container" id="therightstuff">
    <div class="page-header">
        <center>
            <h1>Which machine learning approach do you need?<br>
            <small id="mainsub">Find out in fewer than 7 questions</small>
            </h1>
            <button type="button" class="btn btn-primary" onclick=letsBegin()>Let's Begin</button>
        </center>
    </div>
    <div id="survey" style="padding:0 19px">
    </div>
</div>

<div class="container" id="about" style="display: none">
    <div id="aboutdiv">
        <h3>About:</h3><br>
        <p>This app was generated using my own mental map of how I decide which machine learning approach(es) I might select to solve a problem. I wrote my mental map into a JSON file, created a decision tree, and then converted that decision tree into a javascript function that helps others reason through their own data science challenges.</p>
        <p>The goal of the app: I want this tool to help others understand which analytical approaches might be a great starting point for their app. The result(s) of this survey is an approximation.</p>
        <p>How it works: Answer the questions in the survey until you are provided with a recommendation</p>
        <p>The flowchart: The flowchart is available on the github repo page as a pdf</p>
    </div>
</div>

<div class="container" id="expert" style="display: none">
    <div id="expertdiv">
        <h3>Already an expert?</h3><br>
        <p>If you are experienced in machine learning or statistics, and would like to be forwarded clients, please complete this form (or git pull? I want to make this as easy as possible...). I have my own area of expertise, and limited amount of bandwidth -- this would be a great opportunity to connect clients with experts, and network ourselves!</p>
        <p>Form: Name, Email, Areas of Expertise (and years of experience), Prior Consulting Experience, LinkedIn, Twitter, Languages</p>
    </div>
</div>

<p></p>
<p></p>

<footer class="footer">
    <div class="container">
        <p class="text-muted"></p>
    </div>
</footer>

<script>

// Add back button capability (decrementing stage variable, and be sure to reset userSelected to undefined)
// Add start over button (refresh page, or reset stage variable)

function letsBegin() {
    $(".page-header").hide();
    $("#survey").show()
}

function showAbout() {
    $("#therightstuff").hide();
    $("#expert").hide();
    $("#about").show();
}

function showSurvey() {
    $("#about").hide();
    $("#expert").hide();
    $("#therightstuff").show();
}

function showContact() {
    $("#about").hide();
    $("#therightstuff").hide();
    $("#expert").show();
}

var survey = [
    // In general, I'm not sure should map to YES, just to be on the safe side
    {
        "question" : "Do you have more variables than samples?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Do you have multiple outcome variables?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are your variables independent of each other?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Is time a variable you want to use?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Do you have reason to believe linearity?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are you more concerned with explanatory power, or predictive power?",
        "answers" : ["Explanatory Power", "Predictive Power", "I'm unsure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are you trying to estimate a value, classify, or discover?",
        "answers" : ["Estimate", "Classify", "Discover"],
        "userSelected" : undefined
    }
];

var stage = 0;

function writeQuestion(key) {

    if (key >= survey.length) {
        answer();
        return
    }

    ss = '<div id="'+key+'"><h1>';
    ss += survey[key].question+"</h1><br>";
    for (a in survey[key].answers) {
        ss += '<input type="radio" name="'+key+'" value="'+a+'" onclick=nextUp()> '+survey[key].answers[a]+' <br>'
    }
    ss += '</div>';
    return ss
}

function nextUp() {
    $("#"+stage).hide();
    survey[stage].userSelected = $("#"+stage+" input[type='radio']:checked").val();
    chooser(survey);
    stage += 1;
    $("#survey").append(writeQuestion(stage));
}

function answer(answer) {
    // This function will traverse the survey object after user interaction to provide suggestion
    $("#survey").hide();
    $("#therightstuff").append('<div id="answer"><ul>');
    answer.forEach(function(a) {
        $("#therightstuff").append('<li>'+a);
        if (a in information) {
            $("#therightstuff").append('<ul><li>'+information[a].resources.description+'</li></ul>');
        }
        $("#therightstuff").append('</li>')
    });
    $("#therightstuff").append('</ul></div><p></p>');
    $("#therightstuff").append('<div id="answerme"><p>' +
            "This is an approximation of the technique you need to get started. What you may really want is an <i>ensemble technique -- combining the power of several machine learning techniques</i>. If you have a large number of variables on general, you may also need supplement your model with a dimensionality reduction technique, and/or a regularization method (to ensure the model is not overfit).<p>If you would like to schedule an appointment, please email me your project, timeframe, and budget -- don't worry if you are with a non-profit or academic group, I reserve a portion of my time for pro bono work!</p>"  +
            '</p></div>');
    //add supporting information for the answer
    //add relevant product recommendations
}

function chooser(su) {
    // This function is generated through a python script
    if ( +su[0].userSelected >= 0.5 ) {
        if ( +su[1].userSelected >= 0.5 ) {
            if ( +su[2].userSelected >= 0.5 ) {
                if ( +su[3].userSelected >= 0.5 ) {
                    if ( +su[4].userSelected >= 0.5 ) {
                        if ( +su[5].userSelected >= 0.5 ) {
                            return answer(["svm"])
                        }
                        else if (isNaN(+su[5].userSelected)) {
                            console.log("PASS")
                        }
                        else {
                            if ( +su[6].userSelected >= 0.5 ) {
                                return answer(["Learning Vector Quantization", "Naive Bayes", "decision tree", "knn"])
                            }
                            else if (isNaN(+su[6].userSelected)) {
                                console.log("PASS")
                            }
                            else {
                                if ( +su[6].userSelected >= 1.5 ) {
                                    return answer(["Factor Analysis", "k-means"])
                                }
                                else if (isNaN(+su[6].userSelected)) {
                                    console.log("PASS")
                                }
                                else {
                                    return answer(["Naive Bayes", "svm"])
                                }
                            }
                        }
                    }
                    else if (isNaN(+su[4].userSelected)) {
                        console.log("PASS")
                    }
                    else {
                        if ( +su[6].userSelected >= 0.5 ) {
                            return answer(["Linear Discriminant Analysis"])
                        }
                        else if (isNaN(+su[6].userSelected)) {
                            console.log("PASS")
                        }
                        else {
                            if ( +su[6].userSelected >= 1.5 ) {
                                return answer(["PCA"])
                            }
                            else if (isNaN(+su[6].userSelected)) {
                                console.log("PASS")
                            }
                            else {
                                return answer(["decision tree"])
                            }
                        }
                    }
                }
                else if (isNaN(+su[3].userSelected)) {
                    console.log("PASS")
                }
                else {
                    return answer(["ARIMA", "Hazard Regression"])
                }
            }
            else if (isNaN(+su[2].userSelected)) {
                console.log("PASS")
            }
            else {
                if ( +su[6].userSelected >= 1.0 ) {
                    //estimation
                    return answer(["logistic regression"])
                }
                else if (isNaN(+su[6].userSelected)) {
                    console.log("PASS")
                }
                else {
                    return answer(["linear regression", "logistic regression"])
                }
            }
        }
        else if (isNaN(+su[1].userSelected)) {
            console.log("PASS")
        }
        else {
            if ( +su[5].userSelected >= 0.5 ) {
                return answer(["Neural Network"])
            }
            else if (isNaN(+su[5].userSelected)) {
                console.log("PASS")
            }
            else {
                return answer(["Multivariate Regression"])
            }
        }
    }
    else if (isNaN(+su[0].userSelected)) {
        console.log("PASS")
    }
    else {
        return answer(["random forest"])
    }
}

$(document).ready(function() {
    $("#survey").hide();
    $("#survey").append(writeQuestion(stage));
});

var information = {
    "logistic regression" : {
        "resources" : {
            "description" : "A regression model that can be used for estimation or classification. Expects the outcome variable to be between 0 and 1.",
            "books" : {
                "title":"",
                "link": ""},
            "software" : [],
            "courses" : ["jasonbrownlee"],
            "videos" : [],
            "wikilink" : "https://en.wikipedia.org/wiki/Logistic_regression"
        }
    },
    "linear regression" : {
        "resources" : {
            "description" : "A regression model that assumes a linear relationship -- maybe the simplest, well-used, most accessible model of all",
            "books" : [],
            "software" : [],
            "courses" : [],
            "wikilink" : "https://en.wikipedia.org/wiki/Linear_regression"
            }
    },
    "decision tree" : {
        "resources" : {
            "description" : "A decision tree model can be used for estimation or classification. It has the advantage of being easily interpretable, like a flowchart.",
            "books" : [],
            "software" : [],
            "courses" : [],
            "wikilink" : "https://en.wikipedia.org/wiki/Decision_tree"
        }
    }
};

function addendum(list) {
    //select the right data from information based on techniques returned to user
}

</script>







</body>
</html>

