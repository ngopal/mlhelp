<html>
<head>
    <script src="node_modules/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="node_modules/bootstrap/dist/css/bootstrap-theme.min.css">

</head>

<body>

<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">mlhelp.org</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Action</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">Nav header</li>
                        <li><a href="#">Separated link</a></li>
                        <li><a href="#">One more separated link</a></li>
                    </ul>
                </li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class="container" id="therightstuff">
    <div class="page-header">
        <h1>What machine learning approach do you need?<br>
            <small id="mainsub">Let's figure it out</small>
        </h1>
    </div>
    <div id="survey" style="padding:0 19px">
    </div>
</div>
<p></p>
<p></p>

<footer class="footer">
    <div class="container">
        <p class="text-muted"></p>
    </div>
</footer>

<script>

var survey = [
    // In general, I'm not sure should map to YES, just to be on the safe side
    {
        "question" : "Do you have more variables than samples?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Do you have multiple outcome variables?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are your variables independent of each other?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Is time a variable you want to use?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Do you have reason to believe linearity?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are you more concerned with explanatory power, or predictive power?",
        "answers" : ["Explanatory Power", "Predictive Power", "I'm unsure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are you trying to estimate a value, classify, or discover?",
        "answers" : ["Estimate", "Classify", "Discover"],
        "userSelected" : undefined
    }
];

var stage = 0;

function writeQuestion(key) {

    if (key >= survey.length) {
        answer();
        return
    }

    ss = '<div id="'+key+'">';
    ss += survey[key].question+"<br>";
    for (a in survey[key].answers) {
        ss += '<input type="radio" name="'+key+'" value="'+a+'" onclick=nextUp()> '+survey[key].answers[a]+' <br>'
    }
    ss += '</div>';
    return ss
}

function updateProgress() {
    // change function to read "level" and change progress based on remaining nests?
    return ((stage+1) / survey.length)*100 + "%";
}

function nextUp() {
    $("#"+stage).hide();
    //console.log($("#"+stage+" input[type='radio']:checked").val());
    survey[stage].userSelected = $("#"+stage+" input[type='radio']:checked").val();
    chooser(survey);
    $("#progbar").width(updateProgress());
    stage += 1;
    $("#survey").append(writeQuestion(stage));
}

function answer(answer) {
    // This function will traverse the survey object after user interaction to provide suggestion
    $("#survey").hide();
    $("#therightstuff").append('<div id="answer">'+answer.toString()+'</div>')
}

function chooser(su) {
    // This function is generated through a python script
    if ( +su[0].userSelected >= 0.5 ) {
        if ( +su[1].userSelected >= 0.5 ) {
            if ( +su[2].userSelected >= 0.5 ) {
                if ( +su[3].userSelected >= 0.5 ) {
                    if ( +su[4].userSelected >= 0.5 ) {
                        if ( +su[5].userSelected >= 0.5 ) {
                            return answer(["svm"])
                        }
                        else if (isNaN(+su[5].userSelected)) {
                            console.log("PASS")
                        }
                        else {
                            if ( +su[6].userSelected >= 0.5 ) {
                                return answer(["Learning Vector Quantization", "Naive Bayes", "decision tree", "knn"])
                            }
                            else if (isNaN(+su[6].userSelected)) {
                                console.log("PASS")
                            }
                            else {
                                if ( +su[6].userSelected >= 1.5 ) {
                                    return answer(["Factor Analysis", "k-means"])
                                }
                                else if (isNaN(+su[6].userSelected)) {
                                    console.log("PASS")
                                }
                                else {
                                    return answer(["Naive Bayes", "svm"])
                                }
                            }
                        }
                    }
                    else if (isNaN(+su[4].userSelected)) {
                        console.log("PASS")
                    }
                    else {
                        if ( +su[6].userSelected >= 0.5 ) {
                            return answer(["Linear Discriminant Analysis"])
                        }
                        else if (isNaN(+su[6].userSelected)) {
                            console.log("PASS")
                        }
                        else {
                            if ( +su[6].userSelected >= 1.5 ) {
                                return answer(["PCA"])
                            }
                            else if (isNaN(+su[6].userSelected)) {
                                console.log("PASS")
                            }
                            else {
                                return answer(["decision tree"])
                            }
                        }
                    }
                }
                else if (isNaN(+su[3].userSelected)) {
                    console.log("PASS")
                }
                else {
                    return answer(["ARIMA", "Hazard Regression"])
                }
            }
            else if (isNaN(+su[2].userSelected)) {
                console.log("PASS")
            }
            else {
                if ( +su[6].userSelected >= 1.0 ) {
                    //estimation
                    return answer(["logistic regression"])
                }
                else if (isNaN(+su[6].userSelected)) {
                    console.log("PASS")
                }
                else {
                    return answer(["linear regression", "logistic regression"])
                }
            }
        }
        else if (isNaN(+su[1].userSelected)) {
            console.log("PASS")
        }
        else {
            if ( +su[5].userSelected >= 0.5 ) {
                return answer(["Neural Network"])
            }
            else if (isNaN(+su[5].userSelected)) {
                console.log("PASS")
            }
            else {
                return answer(["Multivariate Regression"])
            }
        }
    }
    else if (isNaN(+su[0].userSelected)) {
        console.log("PASS")
    }
    else {
        return answer(["random forest"])
    }
}

$(document).ready(function() {
   $("#survey").append(writeQuestion(stage));
});

</script>

<div id="about" style="display: none">
    <h3>About:</h3><br>
    <p>This app itself is based on a decision tree of of my own spreadsheet.</p>
    <p>The goal of the app</p>
    <p>How it works</p>
    <p>The flowchart</p>
    <p>The code</p>
</div>





</body>
</html>

