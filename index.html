<html>
<head>
    <script src="https://cdn.rawgit.com/ngopal/mlhelp/master/node_modules/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.rawgit.com/ngopal/mlhelp/master/node_modules/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ngopal/mlhelp/master/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ngopal/mlhelp/master/node_modules/bootstrap/dist/css/bootstrap-theme.min.css">
    <style>
        input[type='radio'] {
            transform: scale(1);
        }
    </style>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-101211891-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>

<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#" onclick=(function(){location.reload()})()>mlhelp.org</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="#" onclick=showSurvey()>Home</a></li>
                <li><a href="#about" onclick=showAbout()>About</a></li>
                <li><a href="#contact" onclick=showContact()>Already an expert?</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class="container" id="therightstuff">
    <div class="page-header">
        <center>
            <h1>Which machine learning approach do you need?<br>
            <small id="mainsub">Find out in fewer than 7 questions</small>
            </h1>
            <button type="button" class="btn btn-primary" onclick=letsBegin()>Let's Begin</button>
        </center>
    </div>
    <div id="survey" style="padding:0 19px">
    </div>
</div>

<div class="container" id="about" style="display: none">
    <div id="aboutdiv">
        <h3>About:</h3><br>
        <p>This app was generated using my own mental map of how I decide which machine learning approach(es) I might select to solve a problem. I wrote my mental map into a JSON file, created a decision tree, and then converted that decision tree into a javascript function that helps others reason through their own data science challenges.</p>
        <p><h3>The goals of the app:</h3>
        <ul>
            <li>I want this tool to help others understand which analytical approaches might be a great starting point for their app. The result(s) of this survey is an approximation.</li>
            <li>I want this tool to help connect others with scientists, researchers, and engineers who can help</li>
        </ul></p>
        <p><h3>How it works:</h3> Answer the questions in the survey until you are provided with a recommendation</p>
        <p><h3>Flowchart and code:</h3> The flowchart is available on the github repo page as a pdf</p>
        <p><h3>What about your book/course/program recommendations?</h3> I have personally used all products endorsed on this page. Many of the resources I point to are free, and a few of them are paid products. I have tried to setup affiliate links for the paid products, but a few of them are here regardless (because they've helped me, and I think they can help you too, regardless of whether or not I'm rewarded for the referral).</p>
    </div>
</div>

<div class="container" id="expert" style="display: none">
    <div id="expertdiv">
        <h3>Already an expert?</h3><br>
        <p>If you are experienced in machine learning or statistics, and would like to be forwarded clients, please complete this form (or git pull? I want to make this as easy as possible...). I have my own area of expertise, and limited amount of bandwidth -- this would be a great opportunity to connect clients with experts, and network ourselves!</p>
        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScBnDo3UywwaITVcGWupzNGwRLDJoYexqzM36p8yMTorsFQ4A/viewform?embedded=true" width="760" height="500" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>
        <p>Link: Look through our database</p>
    </div>
</div>

<p></p>
<p></p>

<footer class="footer">
    <div class="container">
        <p class="text-muted"></p>
    </div>
</footer>

<script>

// Provide different explanations with answer depending on purpose selected by user. Currently, my description is adequate for prediction, but perhaps not discovery.

function letsBegin() {
    $(".page-header").hide();
    $("#survey").show()
}

function showAbout() {
    $("#therightstuff").hide();
    $("#expert").hide();
    $("#about").show();
}

function showSurvey() {
    $("#about").hide();
    $("#expert").hide();
    $("#therightstuff").show();
}

function showContact() {
    $("#about").hide();
    $("#therightstuff").hide();
    $("#expert").show();
}

var survey = [
    // In general, I'm not sure should map to YES, just to be on the safe side
    {
        "question" : "Do you have more variables than samples?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Do you have multiple outcome variables?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are your variables independent of each other?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Is time a variable you want to use?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Do you have reason to believe linearity?",
        "answers" : ["Yes", "No", "I'm not sure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are you more concerned with explanatory power, or predictive power?",
        "answers" : ["Explanatory Power", "Predictive Power", "I'm unsure"],
        "userSelected" : undefined
    },
    {
        "question" : "Are you trying to estimate a value, classify, or discover?",
        "answers" : ["Estimate", "Classify", "Discover"],
        "userSelected" : undefined
    }
];

var stage = 0;

function decrementStage() {
    if (stage <= 0) {
        stage = 0;
        survey[stage].userSelected = undefined;
        resolveOrNextQuestion();
    }
    else {
        $("#"+stage).hide();
        stage -= 1;
        survey[stage].userSelected = undefined;
        resolveOrNextQuestion();
    }
}

function resetStage() {
    var prevStage = stage;
    for (s=0; s <= prevStage; s++) {
        $("#"+s).hide();
        survey[s].userSelected = undefined;
    }
    stage = 0;
    resolveOrNextQuestion();
}

function writeQuestion(key) {

    if (key >= survey.length) {
        answer();
        return
    }
    else if ($("#"+key).length !== 0) {
        $("#"+key).show()
    }
    else {
        ss = '<div id="'+key+'"><h1>';
        ss += survey[key].question+"</h1><br>";
        for (a in survey[key].answers) {
            ss += '<input type="radio" name="'+key+'" value="'+a+'" onclick=nextUp()> '+survey[key].answers[a]+' <br>'
        }
        ss += '<div id="reverselinks"><button type="button" class="btn btn-secondary" onclick=decrementStage()>Previous Question</button> | <button type="button" class="btn btn-secondary" onclick=resetStage()>Start Over</button></div>'
        ss += '</div>';

        return ss
    }
}

function incrementStage() {
    stage += 1;
}

function resolveOrNextQuestion() {
    chooser(survey); // try to resolve answer
    $("#survey").append(writeQuestion(stage)); // write next question
}

function nextUp() {
    $("#"+stage).hide(); // hide question
    survey[stage].userSelected = $("#"+stage+" input[type='radio']:checked").val(); // record selected value
    incrementStage(); // increment stage. this is being incremented after being decremented in another function above
    resolveOrNextQuestion();
}

function answer(answer) {
    // This function will traverse the survey object after user interaction to provide suggestion
    $("#survey").hide();
    $("#therightstuff").append('<div id="answer"><ul>');
    answer.forEach(function(a) {
        $("#therightstuff").append('<li>'+prettytext(a));
        if (a in information) {
            $("#therightstuff").append('<ul><li>'+information[a].resources.description+'</li></ul>');
        }
        $("#therightstuff").append('</li>')
    });
    $("#therightstuff").append('</ul></div><p></p>');
    $("#therightstuff").append('<div id="answerme"><p>' +
            "This is an approximation of the technique you need to get started. What you may really want is an <i>ensemble technique -- combining the power of several machine learning techniques</i>. If you have a large number of variables on general, you may also need supplement your model with a dimensionality reduction technique, and/or a regularization method (to ensure the model is not overfit).<p>If you would like to schedule an appointment, please email me your project, timeframe, and budget -- don't worry if you are with a non-profit or academic group, I reserve a portion of my time for pro bono work!</p>"  +
            '</p>' +
            '<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfZAKi21NgV-EidHCWPHqhOPsD0AnzQFaKA9aEnDsABasPY1g/viewform?embedded=true" width="760" height="500" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>' +
            '</div>');
    //add supporting information for the answer
    //add relevant product recommendations
    //add information about the most difficult parts about ML (feature engineering, tuning, etc)?
    //add information about bayes rate?
}

function chooser(su) {
    // This function is generated through a python script
    if ( +su[0].userSelected >= 0.5 ) {
        if ( +su[1].userSelected >= 0.5 ) {
            if ( +su[2].userSelected >= 0.5 ) {
                if ( +su[3].userSelected >= 0.5 ) {
                    if ( +su[4].userSelected >= 0.5 ) {
                        if ( +su[5].userSelected >= 0.5 ) {
                            return answer(["svm"])
                        }
                        else if (isNaN(+su[5].userSelected)) {
                            console.log("PASS")
                        }
                        else {
                            if ( +su[6].userSelected >= 0.5 ) {
                                return answer(["Learning Vector Quantization", "Naive Bayes", "decision tree", "knn"])
                            }
                            else if (isNaN(+su[6].userSelected)) {
                                console.log("PASS")
                            }
                            else {
                                if ( +su[6].userSelected >= 1.5 ) {
                                    return answer(["Factor Analysis", "k-means"])
                                }
                                else if (isNaN(+su[6].userSelected)) {
                                    console.log("PASS")
                                }
                                else {
                                    return answer(["Naive Bayes", "svm"])
                                }
                            }
                        }
                    }
                    else if (isNaN(+su[4].userSelected)) {
                        console.log("PASS")
                    }
                    else {
                        if ( +su[6].userSelected >= 0.5 ) {
                            return answer(["Linear Discriminant Analysis"])
                        }
                        else if (isNaN(+su[6].userSelected)) {
                            console.log("PASS")
                        }
                        else {
                            if ( +su[6].userSelected >= 1.5 ) {
                                return answer(["PCA"])
                            }
                            else if (isNaN(+su[6].userSelected)) {
                                console.log("PASS")
                            }
                            else {
                                return answer(["decision tree"])
                            }
                        }
                    }
                }
                else if (isNaN(+su[3].userSelected)) {
                    console.log("PASS")
                }
                else {
                    return answer(["ARIMA", "Hazard Regression"])
                }
            }
            else if (isNaN(+su[2].userSelected)) {
                console.log("PASS")
            }
            else {
                if ( +su[6].userSelected >= 1.0 ) {
                    //estimation
                    return answer(["logistic regression"])
                }
                else if (isNaN(+su[6].userSelected)) {
                    console.log("PASS")
                }
                else {
                    return answer(["linear regression", "logistic regression"])
                }
            }
        }
        else if (isNaN(+su[1].userSelected)) {
            console.log("PASS")
        }
        else {
            if ( +su[5].userSelected >= 0.5 ) {
                return answer(["Neural Network"])
            }
            else if (isNaN(+su[5].userSelected)) {
                console.log("PASS")
            }
            else {
                return answer(["Multivariate Regression"])
            }
        }
    }
    else if (isNaN(+su[0].userSelected)) {
        console.log("PASS")
    }
    else {
        return answer(["random forest"])
    }
}

$(document).ready(function() {
    $("#survey").hide();
    $("#survey").append(writeQuestion(stage));
});

var resources = [
        {"title" : "Practical Data Science",
            "type": "book",
        "link" : "https://www.amazon.com/Practical-Data-Science-Nina-Zumel/dp/1617291560/ref=sr_1_2?ie=UTF8&qid=1497652211&sr=8-2&keywords=practical+data+science",
        "relevantContext" : ["linear regression", "logistic regression"]},
        {"title" : "machinelearningmastery.com",
        "type":"course",
        "link": "",
        "relevantContext" : []},
    {"title" : "Coursera",
        "type":"course",
        "link": "",
        "relevantContext" : []},
    {"title" : "sklearn",
        "type":"software",
        "link": "",
        "relevantContext" : []},
    {"title" : "Collective Intelligence",
        "type":"book",
        "link": "",
        "relevantContext" : []},
    {"title" : "WEKA",
        "type":"software",
        "link": "",
        "relevantContext" : []}
    ];

var information = {
    "logistic regression" : {
        "resources" : {
            "description" : "A regression model that can be used for estimation or classification. Expects the outcome variable to be between 0 and 1.",
            "books" : {
                "title":"",
                "link": ""},
            "software" : [],
            "courses" : ["jasonbrownlee"],
            "videos" : [],
            "wikilink" : "https://en.wikipedia.org/wiki/Logistic_regression",
            "title" : "Logistic Regression"
        }
    },
    "linear regression" : {
        "resources" : {
            "description" : "A regression model that assumes a linear relationship -- maybe the simplest, well-used, most accessible model of all",
            "books" : [],
            "software" : [],
            "courses" : [],
            "wikilink" : "https://en.wikipedia.org/wiki/Linear_regression",
            "title" : "Linear Regression"
            }
    },
    "decision tree" : {
        "resources" : {
            "description" : "A decision tree model can be used for estimation or classification. It has the advantage of being easily interpretable, like a flowchart.",
            "books" : [],
            "software" : [],
            "courses" : [],
            "wikilink" : "https://en.wikipedia.org/wiki/Decision_tree",
            "title" : "Decision Tree"
        }
    },
    "svm" : {
        "resources" : {
            "title" : "Support Vector Machine",
            "description" : "A method used to find a \"decision boundary\" that best separates data."
        }
    },
    "PCA" : {
        "resources" : {
            "title" : "Principal Components Analysis",
            "description" : "A method used to condense the number of variables used in a model."
        }
    },
    "knn" : {
        "resources" : {
            "title" : "K Nearest Neighbors",
            "description" : "A method that will classify new data points based on its proximity to other data points (i.e. its neighbors)."
        }
    },
    "k-means" : {
        "resources" : {
            "title" : "K-means",
            "description" : "A method that will group data points"
        }
    },
    "Naive Bayes" : {
        "resources" : {
            "title" : "Naive Bayes",
            "description": "A method that uses conditional probability to provide an estimate."
        }
    },
    "random forest" : {
        "resources" : {
            "title" : "Random Forest",
            "description" : "Ideal as a starting point for analysis, and general workhorse in the world of machine learning. This method creates and \"averages\" a number of decision trees."
        }
    }
};

function prettytext(x) {
    if (x in information) {
        return information[x].resources.title
    }
    else {
        return x
    }
}

function addendum(list) {
    //select the right data from information based on techniques returned to user
}

</script>







</body>
</html>

